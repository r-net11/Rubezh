<UserControl
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:extToolkit="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit.Extended"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
	x:Class="SettingsModule.Views.GloobalSettingsView"
	MinWidth="600" MinHeight="420">
	<TabControl>
		<TabItem DataContext="{Binding AppServerViewModel}" Header="Сервер">
			<Grid Margin="2">
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>
				<Grid Grid.Row="0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto" />
						<ColumnDefinition Width="*" />
					</Grid.ColumnDefinitions>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto" />
						<RowDefinition Height="Auto" />
						<RowDefinition Height="Auto" />
						<RowDefinition Height="Auto" />
						<RowDefinition Height="Auto" />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>

					<TextBlock Grid.Row="0" Grid.Column="0" Text="Разрешить удаленные соединения на сервере" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2" />
					<CheckBox Grid.Row="0" Grid.Column="1" IsChecked="{Binding EnableRemoteConnections}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="2" />

					<TextBlock Grid.Row="1" Grid.Column="0" Text="IP-адрес сервера" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2" />
					<ComboBox Grid.Row="1" Grid.Column="1" ItemsSource="{Binding AvailableIpAddresses}" SelectedItem="{Binding ServiceAddress}" IsEnabled="{Binding EnableRemoteConnections}" VerticalAlignment="Center" Margin="2" />

					<TextBlock Grid.Row="2" Grid.Column="0" Text="Порт" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2" />
					<extToolkit:IntegerUpDown Grid.Row="2" Grid.Column="1" Value="{Binding ServicePort, UpdateSourceTrigger=PropertyChanged}" Minimum="0" Maximum="65535" VerticalAlignment="Center" Margin="2" />

					<TextBlock Grid.Row="3" Grid.Column="0" Text="Порт сервиса отчетов" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2" />
					<extToolkit:IntegerUpDown Grid.Row="3" Grid.Column="1" Value="{Binding ReportServicePort, UpdateSourceTrigger=PropertyChanged}" Minimum="0" Maximum="65535" VerticalAlignment="Center" Margin="2" />

					<TextBlock
						Grid.Row="4"
						Grid.Column="0"
						Margin="2"
						HorizontalAlignment="Right"
						VerticalAlignment="Center"
						Text="Использовать HASP"
						Foreground="{DynamicResource ForegroundColorLight}"/>
					<CheckBox
						Grid.Row="4"
						Grid.Column="1"
						Margin="2"
						HorizontalAlignment="Left"
						VerticalAlignment="Center"
						IsChecked="{Binding UseHasp}" />
					<TextBlock
						Grid.Row="6"
						Grid.Column="0"
						Margin="2"
						HorizontalAlignment="Right"
						VerticalAlignment="Center"
						Text="Создавать новую БД при переполнении"
						Foreground="{DynamicResource ForegroundColorLight}"/>
					<CheckBox
						Grid.Row="6"
						Grid.Column="1"
						Margin="2"
						HorizontalAlignment="Left"
						VerticalAlignment="Center"
						IsChecked="{Binding CreateNewDBOnOversize}" />
				</Grid>
				<GroupBox Grid.Row="1" Header="Настройка базы данных" Margin="2 10">
					<GroupBox.HeaderTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding}" Foreground="{DynamicResource ForegroundColorLight}"/>
						</DataTemplate>
					</GroupBox.HeaderTemplate>
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="*"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>
						<Grid Grid.Row="0">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>
							<Grid.RowDefinitions>
								<RowDefinition/>
								<RowDefinition/>
								<RowDefinition/>
								<RowDefinition/>
								<RowDefinition/>
								<RowDefinition/>
							</Grid.RowDefinitions>
							<TextBlock Grid.Row="0" Grid.Column="0" Text="IP-адрес сервера баз данных" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2"/>
							<TextBox Grid.Row="0" Grid.Column="1" Text="{Binding DBServerAddress}" VerticalAlignment="Center" Margin="2"/>
							<TextBlock Grid.Row="1" Grid.Column="0" Text="Порт сервера баз данных" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2"/>
							<extToolkit:IntegerUpDown Grid.Row="1" Grid.Column="1" Value="{Binding DBServerPort, UpdateSourceTrigger=PropertyChanged}" Minimum="0" Maximum="65535" VerticalAlignment="Center" Margin="2"/>
							<TextBlock Grid.Row="2" Grid.Column="0" Text="Название экземпляра сервера БД" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2"/>
							<TextBox Grid.Row="2" Grid.Column="1" Text="{Binding DBServerName}" VerticalAlignment="Center" Margin="2"/>
							<TextBlock Grid.Row="3" Grid.Column="0" Text="Аутентификация" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2"/>
							<ComboBox Grid.Row="3" Grid.Column="1" ItemsSource="{Binding AvailableSqlServerAuthenticationModes}" SelectedItem="{Binding SqlServerAuthenticationMode}" VerticalAlignment="Center" Margin="2"/>
							<TextBlock Grid.Row="4" Grid.Column="0" Text="Логин сервера БД" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2"/>
							<TextBox Grid.Row="4" Grid.Column="1" Text="{Binding DBUserID}" VerticalAlignment="Center" IsEnabled="{Binding UseSqlServerAuthentication}" Margin="2"/>
							<TextBlock Grid.Row="5" Grid.Column="0" Text="Пароль сервера БД" Foreground="{DynamicResource ForegroundColorLight}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="2"/>
							<TextBox Grid.Row="5" Grid.Column="1" Text="{Binding DBUserPwd}" VerticalAlignment="Center" IsEnabled="{Binding UseSqlServerAuthentication}" Margin="2"/>
						</Grid>
						<Button Grid.Row="1" Content="Проверка соединения" Command="{Binding CheckSqlServerConnectionCommand}" Width="150" HorizontalAlignment="Right" Margin="2"/>
					</Grid>
				</GroupBox>
			</Grid>
		</TabItem>
		<TabItem Header="Автозапуск">
			<StackPanel Margin="2">
				<TextBlock
					Margin="2"
					FontSize="12"
					Foreground="{DynamicResource ForegroundColorLight}"
					Text="Следующие приложения будут автоматически запускаться при старте системы:"
					TextWrapping="Wrap" />
				<CheckBox
					Margin="5 5 5 1"
					Content="{Binding ServerAutoLabel}"
					FontSize="12"
					Foreground="{DynamicResource ForegroundColorLight}"
					IsChecked="{Binding IsServerAuto}" />
			</StackPanel>
		</TabItem>
		<TabItem Header="Логи">
			<Border
				Margin="2"
				Background="White"
				CornerRadius="5">
				<StackPanel Margin="2">
					<TextBox
						Margin="2"
						Background="LightGray"
						Text="{Binding LogsFolderPath, Mode=OneWay}" />
					<StackPanel Orientation="Horizontal">
						<Button
							Width="150"
							Margin="2"
							Command="{Binding SaveLogsCommand}"
							Content="Сохранить логи"
							FontSize="13" />
						<Button
							Width="150"
							Margin="2"
							Command="{Binding RemoveLogsCommand}"
							Content="Удалить логи"
							FontSize="13" />
					</StackPanel>
				</StackPanel>
			</Border>
		</TabItem>
		<TabItem DataContext="{Binding GlobalSettings}" Header="Соединение">
			<Grid Margin="2">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="*" />
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>
				<TextBlock
					Grid.Row="0"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Адрес сервера"
					Foreground="{DynamicResource ForegroundColorLight}"/>
				<TextBox
					Grid.Row="0"
					Grid.Column="1"
					VerticalAlignment="Center"
					Margin="2"
					Text="{Binding RemoteAddress, UpdateSourceTrigger=PropertyChanged}" />
				<TextBlock
					Grid.Row="1"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Порт сервера"
					Foreground="{DynamicResource ForegroundColorLight}"/>
				<extToolkit:IntegerUpDown
					Grid.Row="1"
					Grid.Column="1"
					VerticalAlignment="Center"
					Margin="2"
					Value="{Binding RemotePort, UpdateSourceTrigger=PropertyChanged}"
					Minimum="0" Maximum="65535" />
				<TextBlock
					Grid.Row="2"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Порт сервиса отчетов"
					Foreground="{DynamicResource ForegroundColorLight}"/>
				<extToolkit:IntegerUpDown
					Grid.Row="2"
					Grid.Column="1"
					VerticalAlignment="Center"
					Margin="2"
					Value="{Binding ReportRemotePort, UpdateSourceTrigger=PropertyChanged}"
					Minimum="0" Maximum="65535" />
				<TextBlock
					Grid.Row="3"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Логин"
					Foreground="{DynamicResource ForegroundColorLight}"/>
				<TextBox
					Grid.Row="3"
					Grid.Column="1"
					VerticalAlignment="Center"
					Margin="2"
					Text="{Binding Login, UpdateSourceTrigger=PropertyChanged}" />
				<TextBlock
					Grid.Row="4"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Пароль"
					Foreground="{DynamicResource ForegroundColorLight}"/>
				<TextBox
					Grid.Row="4"
					Grid.Column="1"
					VerticalAlignment="Center"
					Margin="2"
					Text="{Binding Password, UpdateSourceTrigger=PropertyChanged}" />
				<TextBlock
					Grid.Row="5"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Автоконнект"
					Foreground="{DynamicResource ForegroundColorLight}"/>
				<CheckBox
					Grid.Row="5"
					Grid.Column="1"
					Margin="2"
					HorizontalAlignment="Left"
					VerticalAlignment="Center"
					IsChecked="{Binding AutoConnect}" />
				<TextBlock
					Grid.Row="6"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Запретить администратору автоконнект"
					Foreground="{DynamicResource ForegroundColorLight}"/>
				<CheckBox
					Grid.Row="6"
					Grid.Column="1"
					Margin="2"
					HorizontalAlignment="Left"
					VerticalAlignment="Center"
					IsChecked="{Binding DoNotAutoconnectAdm}" />
				<TextBlock
					Grid.Row="7"
					Grid.Column="0"
					Margin="2"
					HorizontalAlignment="Right"
					VerticalAlignment="Center"
					Text="Перезапускать ОЗ в случае аварийного завершения"
					 Foreground="{DynamicResource ForegroundColorLight}"/>

				<CheckBox
					Grid.Row="7"
					Grid.Column="1"
					Margin="2"
					HorizontalAlignment="Left"
					VerticalAlignment="Center"
					IsChecked="{Binding RunRevisor}" />
			</Grid>
		</TabItem>
		<TabItem DataContext="{Binding ModulesViewModel}" Header="Модули">
			<DataGrid
				Margin="2"
				IsReadOnly="False"
				ItemsSource="{Binding Modules}">
				<DataGrid.Columns>
					<DataGridTemplateColumn Width="1*" Header="Наименование">
						<DataGridTemplateColumn.CellTemplate>
							<DataTemplate>
								<StackPanel IsEnabled="{Binding CanChange}" Orientation="Horizontal">
									<CheckBox Margin="5 2" IsChecked="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
									<TextBlock Margin="2 0" Text="{Binding Description}" />
								</StackPanel>
							</DataTemplate>
						</DataGridTemplateColumn.CellTemplate>
					</DataGridTemplateColumn>
				</DataGrid.Columns>
			</DataGrid>
		</TabItem>
		<TabItem Header="Сброс" Visibility="{Binding IsDebug, Converter={StaticResource BoolToVisibilityConverter}}">
			<Border
				Margin="2"
				Background="White"
				CornerRadius="5">
				<StackPanel Margin="2">
					<Button
						Width="300"
						Margin="2"
						Command="{Binding ResetDatabaseCommand}"
						Content="Сбросить базу данных" />
					<Button
						Width="300"
						Margin="2"
						Command="{Binding ResetConfigurationCommand}"
						Content="Сбросить конфигурацию" />
					<Button
						Width="300"
						Margin="2"
						Command="{Binding ResetSKDLibaryCommand}"
						Content="Сбросить библиотеку СКД" />
					<Button
						Width="300"
						Margin="2"
						Command="{Binding ResetSettingsCommand}"
						Content="Сбросить настройки" />
				</StackPanel>
			</Border>
		</TabItem>
		<TabItem
			DataContext="{Binding GlobalSettings}"
			Header="Отладка"
			Visibility="{Binding IsDebug, Converter={StaticResource BoolToVisibilityConverter}}">
			<Grid Margin="2">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="*" />
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>
			</Grid>
		</TabItem>
	</TabControl>
</UserControl>