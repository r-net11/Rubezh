<UserControl
	x:Class="SKDModule.Views.OrganisationsView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
	xmlns:viewModels="clr-namespace:SKDModule.ViewModels"
	xmlns:lang="clr-namespace:Localization.SKD.Views;assembly=Localization"
	d:DesignHeight="250"
	d:DesignWidth="400"
	mc:Ignorable="d">
	<UserControl.Resources>
		<CollectionViewSource x:Key="cvsOrganisations" Source="{Binding Organisations}">
			<CollectionViewSource.SortDescriptions>
				<scm:SortDescription PropertyName="Organisation.Name" />
			</CollectionViewSource.SortDescriptions>
		</CollectionViewSource>
	</UserControl.Resources>
	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition
				Width="Auto"
				MinWidth="150"
				MaxWidth="500" />
			<ColumnDefinition Width="Auto" />
			<ColumnDefinition Width="*" />
		</Grid.ColumnDefinitions>
		<ListBox ItemsSource="{Binding Source={StaticResource cvsOrganisations}}" SelectedItem="{Binding SelectedOrganisation}">
			<ListBox.ItemTemplate>
				<DataTemplate>
					<StackPanel Orientation="Horizontal">
						<Image
							Width="16"
							Margin="1 0 0 0"
							VerticalAlignment="Center"
							Source="/Controls;component/Images/Organisation.png" />
						<TextBlock Style="{StaticResource IsDeletedStyle}" Text="{Binding Organisation.Name}" />
					</StackPanel>
				</DataTemplate>
			</ListBox.ItemTemplate>
		</ListBox>
		<GridSplitter
			Grid.Column="1"
			Width="5"
			HorizontalAlignment="Stretch"
			VerticalAlignment="Stretch"
			Background="Transparent"
			Cursor="SizeWE" />
		<TabControl Grid.Column="2">
            <TabItem DataContext="{Binding OrganisationUsersViewModel}" Header="{x:Static lang:CommonViews.Users}">
				<TabItem.Resources>
					<CollectionViewSource x:Key="cvsItems" Source="{Binding Items}">
						<CollectionViewSource.SortDescriptions>
							<scm:SortDescription PropertyName="User.Name" />
						</CollectionViewSource.SortDescriptions>
					</CollectionViewSource>
				</TabItem.Resources>
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="*" />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>
					<ListBox IsEnabled="{Binding CanSelect}" ItemsSource="{Binding Source={StaticResource cvsItems}}">
						<ListBox.ItemContainerStyle>
							<Style TargetType="{x:Type ListBoxItem}">
								<Setter Property="Focusable" Value="False" />
							</Style>
						</ListBox.ItemContainerStyle>
						<ListBox.ItemTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<Image
										Margin="1 0"
										VerticalAlignment="Center"
										Source="/Controls;component/Images/SKDUser.png" />
									<CheckBox
										Margin="2"
										Content="{Binding User.Name}"
										IsChecked="{Binding IsChecked,
									                              Mode=TwoWay,
									                              UpdateSourceTrigger=PropertyChanged}" />
								</StackPanel>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
					<StackPanel Grid.Row="1" Orientation="Horizontal">
						<ToolBarButton
							Command="{Binding SelectAllCommand}"
							ImageSource="SelectAll"
							ToolTip="{x:Static lang:CommonViews.ChooseAll}" />
						<ToolBarButton
							Command="{Binding SelectNoneCommand}"
							ImageSource="SelectNone"
							ToolTip="{x:Static lang:CommonViews.CancelChoose}" />
					</StackPanel>
				</Grid>
			</TabItem>
            <TabItem Header="{x:Static lang:CommonViews.AccessPoint}">
				<Grid DataContext="{Binding OrganisationDoorsViewModel}">
					<Grid.Resources>
						<CollectionViewSource x:Key="cvsOrganisationItems" Source="{Binding Items}">
							<CollectionViewSource.SortDescriptions>
								<scm:SortDescription PropertyName="No" />
							</CollectionViewSource.SortDescriptions>
						</CollectionViewSource>
					</Grid.Resources>
					<Grid.RowDefinitions>
						<RowDefinition Height="*" />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>
					<DataGrid
						CanUserResizeColumns="True"
						CanUserSortColumns="True"
						IsEnabled="{Binding CanSelect}"
						ItemsSource="{Binding Source={StaticResource cvsOrganisationItems}}">
						<DataGrid.Columns>
							<DataGridTemplateColumn>
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<Grid>
											<Grid.ColumnDefinitions>
												<ColumnDefinition />
												<ColumnDefinition />
											</Grid.ColumnDefinitions>
											<Image
												Width="16"
												Margin="1 0"
												VerticalAlignment="Center"
												Source="/Controls;component/Images/Door.png" />
											<CheckBox
												Grid.Column="1"
												Margin="2 0 0 0"
												IsChecked="{Binding IsChecked,
											                              Mode=TwoWay,
											                              UpdateSourceTrigger=PropertyChanged}" />
										</Grid>
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
							<DataGridTemplateColumn
								Width="40"
								Header="№"
								SortMemberPath="No">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<TextBlock Margin="4 0 0 0" Text="{Binding No}" />
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
							<DataGridTemplateColumn
								Width="0.5*"
								Header="{x:Static lang:CommonViews.Name}"
								SortMemberPath="Name">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<TextBlock Margin="4 0 0 0" Text="{Binding Name}" />
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
						</DataGrid.Columns>
					</DataGrid>
					<StackPanel Grid.Row="1" Orientation="Horizontal">
						<ToolBarButton
							Command="{Binding SelectAllCommand}"
							ImageSource="SelectAll"
							ToolTip="{x:Static lang:CommonViews.ChooseAll}" />
						<ToolBarButton
							Command="{Binding SelectNoneCommand}"
							ImageSource="SelectNone"
							ToolTip="{x:Static lang:CommonViews.CancelChoose}" />
					</StackPanel>
				</Grid>
			</TabItem>
		</TabControl>
	</Grid>
</UserControl>