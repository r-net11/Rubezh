<UserControl
	x:Class="FiresecService.Views.MainView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:res="clr-namespace:FiresecService.Resources.Language.Views"
	MinWidth="400"
	MinHeight="300"
	xmlns:views="clr-namespace:FiresecService.Views"
	Loaded="UserControl_Loaded">
	<Grid Margin="10">
		<Grid.RowDefinitions>
			<RowDefinition Height="*" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>
		<TabControl Background="{DynamicResource AlternativeBackgroundBrush}">
			<!--<TabItem Header="Соединения">-->
			<TabItem Header="{x:Static res:MainView.TabItem_Connections}">
				<DataGrid ItemsSource="{Binding Clients}" SelectedItem="{Binding SelectedClient}">
					<DataGrid.Columns>
						<!--<DataGridTemplateColumn Header="Идентификатор">-->
						<DataGridTemplateColumn Header="{x:Static res:MainView.DataGridTemplateColumn_Identifier}">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<StackPanel Orientation="Horizontal">
										<CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="2 0 2 0" />
										<TextBlock Text="{Binding UID}"/>
									</StackPanel>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
                        
                        <!--<DataGridTextColumn Binding="{Binding ClientType}" Header="Тип" />
                        <DataGridTextColumn Binding="{Binding IpAddress}" Header="Адрес" />
                        <DataGridTextColumn Width="*" Binding="{Binding FriendlyUserName}" Header="Пользователь" />-->
                        <DataGridTextColumn Binding="{Binding ClientType}" Header="{x:Static res:MainView.DataGridTextColumn_Type}" />
                        <DataGridTextColumn Binding="{Binding IpAddress}" Header="{x:Static res:MainView.DataGridTextColumn_Address}" />
                        <DataGridTextColumn Width="*" Binding="{Binding FriendlyUserName}" Header="{x:Static res:MainView.DataGridTextColumn_User}" />
					</DataGrid.Columns>
				</DataGrid>
			</TabItem>
			<TabItem Header='ОПС "Рубеж"'>
				<views:RubezhClientView />
			</TabItem>
			<TabItem Header="Лог">
				<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
					<TextBox HorizontalContentAlignment="Left" VerticalContentAlignment="Top" AcceptsReturn="True" IsReadOnly="True" ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto" Text="{Binding InfoLog}" TextWrapping="WrapWithOverflow" />
				</ScrollViewer>
			</TabItem>
			<!--<TabItem Header="Лицензирование">-->
            <TabItem Header="{x:Static res:MainView.TabItem_License}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto" />
						<RowDefinition />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>
					<StackPanel Orientation="Horizontal">
						<TextBlock
							Text="{x:Static res:MainView.TextBlock_LicenseStatus}"
							Foreground="White"
							VerticalAlignment="Center"
							Margin="5"/>
						<TextBlock
							Text="{Binding LicenseStatusText, FallbackValue={x:Static res:MainView.TextBlock_EmptyLicense}}"
							Foreground="White"
							VerticalAlignment="Center"
							Margin="5"/>
					</StackPanel>
					<DataGrid
						Grid.Row="1"
						HeadersVisibility="None"
						ItemsSource="{Binding LicenseItems, IsAsync=True}">
						<DataGrid.Columns>
							<DataGridTemplateColumn Width="Auto">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<TextBlock
											Text="{Binding Key}"
											Margin="5 0"
											VerticalAlignment="Center"/>
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
							<DataGridTemplateColumn Width="*">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<TextBlock
											Text="{Binding Value}"
											Margin="5 0"
											VerticalAlignment="Center"/>
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
						</DataGrid.Columns>
					</DataGrid>
					<Grid Grid.Row="2">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition />
							<ColumnDefinition Width="Auto" />
						</Grid.ColumnDefinitions>
						<TextBlock
							Text="{x:Static res:MainView.TextBlock_Id}"
							Foreground="White"
							VerticalAlignment="Center"
							Margin="5"/>
						<TextBox
							Grid.Column="1"
							IsReadOnly="True"
							Text="{Binding UserKey, Mode=OneWay}"
							Margin="5"
							VerticalAlignment="Center" />
						<Button
							Grid.Column="2"
							Content="{x:Static res:MainView.Button_LoadLicense}"
							Command="{Binding LoadLicenseCommand}"
							VerticalAlignment="Center"
							Width="140"
							Margin="5"/>
					</Grid>
				</Grid>
			</TabItem>
		</TabControl>
		<Grid Grid.Row="1">
            <TextBlock Margin="5 0 0 0" FontSize="11" FontWeight="Bold" Foreground="Orange" Text="{Binding LastLog, FallbackValue={x:Static res:MainView.TextBlock_LastLog}}" />
            <Button Content="{x:Static res:MainView.Button_ReleaseConnection}" Command="{Binding ReleaseClientsCommand}" Width="150" HorizontalAlignment="Right"/>
		</Grid>
	</Grid>
</UserControl>