<UserControl
	x:Class="FiresecService.Views.MainView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	MinWidth="400"
	MinHeight="400"
	Loaded="UserControl_Loaded">
	<Grid Margin="10">
		<Grid.RowDefinitions>
			<RowDefinition Height="*" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>
		<TabControl Grid.Row="0" Background="{DynamicResource AlternativeBackgroundBrush}">
			<TabItem Header="Соединения">
				<DataGrid ItemsSource="{Binding Clients}" SelectedItem="{Binding SelectedClient}">
					<DataGrid.Columns>
						<DataGridTextColumn Binding="{Binding ClientType}" Header="Тип" />
						<DataGridTextColumn Binding="{Binding IpAddress}" Header="Адрес" />
						<DataGridTextColumn Width="*" Binding="{Binding FriendlyUserName}" Header="Пользователь" />
					</DataGrid.Columns>
				</DataGrid>
			</TabItem>
			<TabItem Header="Лог">
				<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
					<TextBox HorizontalContentAlignment="Left" VerticalContentAlignment="Top" AcceptsReturn="True" IsReadOnly="True" ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto" Text="{Binding InfoLog}" TextWrapping="WrapWithOverflow" />
				</ScrollViewer>
			</TabItem>
			<TabItem Header="Лицензирование">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto" />
						<RowDefinition />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>
					<StackPanel Orientation="Horizontal">
						<TextBlock
							Text="Статус лицензии:"
							Foreground="White"
							VerticalAlignment="Center"
							Margin="5"/>
						<TextBlock
							Text="{Binding LicenseStatusText, FallbackValue=Лицензия отсутствует}"
							Foreground="White"
							VerticalAlignment="Center"
							Margin="5"/>
					</StackPanel>
					<DataGrid
						Grid.Row="1"
						HeadersVisibility="None"
						ItemsSource="{Binding LicenseItems, IsAsync=True}">
						<DataGrid.Columns>
							<DataGridTemplateColumn Width="Auto">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<TextBlock
											Text="{Binding Key}"
											Margin="5 0"
											VerticalAlignment="Center"/>
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
							<DataGridTemplateColumn Width="*">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<TextBlock
											Text="{Binding Value}"
											Margin="5 0"
											VerticalAlignment="Center"/>
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
						</DataGrid.Columns>
					</DataGrid>
					<Grid Grid.Row="2">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition />
							<ColumnDefinition Width="Auto" />
						</Grid.ColumnDefinitions>
						<TextBlock
							Text="Ид. номер:"
							Foreground="White"
							VerticalAlignment="Center"
							Margin="5"/>
						<TextBox
							Grid.Column="1"
							IsReadOnly="True"
							Text="{Binding UserKey, Mode=OneWay}"
							Margin="5"
							VerticalAlignment="Center" />
						<Button
							Grid.Column="2"
							Content="Загрузить лицензию"
							Command="{Binding LoadLicenseCommand}"
							VerticalAlignment="Center"
							Width="140"
							Margin="5"/>
					</Grid>
				</Grid>
			</TabItem>
		</TabControl>
		<Grid Grid.Row="1">
			<TextBlock Margin="5 0 0 0" FontSize="11" FontWeight="Bold" Foreground="Orange" Text="{Binding LastLog, FallbackValue=None}" />
		</Grid>
	</Grid>
</UserControl>