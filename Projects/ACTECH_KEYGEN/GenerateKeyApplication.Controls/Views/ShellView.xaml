<Window
	x:Class="GenerateKeyApplication.Controls.Views.ShellView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:cal="http://www.caliburnproject.org"
	Width="700"
	SizeToContent="Height"
	xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
	xmlns:converters="clr-namespace:GenerateKeyApplication.Controls.Converters"
	xmlns:model="clr-namespace:GenerateKeyApplication.Model.Enums;assembly=GenerateKeyApplication.Model"
	WindowStartupLocation="CenterScreen"
	Title="Генератор лицензий">
	<Window.Resources>
		<converters:InvertedBooleanConverter x:Key="InvertedBooleanConverter" />
		<converters:InvertedBoolToVisibilityConverter x:Key="InvertedBoolToVisibilityConverter" />
		<converters:EnumToBooleanConverter x:Key="EnumToBooleanConverter" />
	</Window.Resources>
	<Grid Background="#2035CFFB" FocusManager.FocusedElement="{Binding ElementName=GenerateButton}" IsSharedSizeScope="True">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="Auto" />
			<ColumnDefinition />
		</Grid.ColumnDefinitions>
		<xctk:WatermarkTextBox
			Grid.ColumnSpan="2"
			Watermark="Пользовательский идентификатор"
			Text="{Binding CurrentLicense.UID, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
			VerticalContentAlignment="Center"
			Margin="15 15 15 5"/>
		<GroupBox
			Grid.Row="1"
			Header="Подключения"
			IsEnabled="{Binding ElementName=DemoRadioButton, Path=IsChecked, Converter={StaticResource InvertedBooleanConverter}}"
			Margin="15 5">
			<Grid Margin="15 5">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" SharedSizeGroup="FirstColumn" />
					<ColumnDefinition />
				</Grid.ColumnDefinitions>
				<TextBlock
					VerticalAlignment="Center"
					Text="Оперативная задача"
					Margin="5"/>
				<xctk:IntegerUpDown
					Grid.Column="1"
					Value="{Binding CurrentLicense.OperatorConnectionsNumber}"
					VerticalAlignment="Center"
					Margin="5"/>
			</Grid>
		</GroupBox>
		<GroupBox
			Grid.Row="1"
			Grid.Column="1"
			Header="Тип лицензии"
			Margin="15 5">
			<StackPanel Margin="15 5">
				<RadioButton
					x:Name="DemoRadioButton"
					Content="Демо версия"
					IsChecked="{Binding Path=CurrentLicense.LicenseType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static model:LicenseType.Demo}}"
					Margin="5" />
				<RadioButton
					Content="Продуктовая версия"
					IsChecked="{Binding Path=CurrentLicense.LicenseType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static model:LicenseType.Product}}"
					Margin="5" />
			</StackPanel>
		</GroupBox>
		<GroupBox
			Grid.Row="2"
			Header="Пользователи"
			IsEnabled="{Binding ElementName=DemoRadioButton, Path=IsChecked, Converter={StaticResource InvertedBooleanConverter}}"
			Margin="15 5">
			<Grid Margin="15 5">
				<Grid.RowDefinitions>
					<RowDefinition />
					<RowDefinition />
					<RowDefinition />
					<RowDefinition />
					<RowDefinition />
					<RowDefinition />
				</Grid.RowDefinitions>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" SharedSizeGroup="FirstColumn" />
					<ColumnDefinition />
				</Grid.ColumnDefinitions>
				<TextBlock
					Text="Неограничено"
					VerticalAlignment="Center"
					Margin="5"/>
				<CheckBox
					x:Name="UnlimitedBox"
					Grid.Column="1"
					IsChecked="{Binding CurrentLicense.IsUnlimitedUsers}"
					VerticalAlignment="Center"
					VerticalContentAlignment="Center"
					HorizontalAlignment="Left"/>
				<TextBlock
					Grid.Row="1"
					Text="200 пользователей"
					VerticalAlignment="Center"
					Margin="5"/>
				<xctk:IntegerUpDown
					Grid.Column="1"
					Grid.Row="1"
					IsEnabled="{Binding ElementName=UnlimitedBox, Path=IsChecked, Converter={StaticResource InvertedBooleanConverter}}"
					Value="{Binding TwoHundredRate}"
					VerticalAlignment="Center"
					Margin="5"/>
				<TextBlock
					Grid.Row="2"
					Text="1000 пользователей"
					VerticalAlignment="Center"
					Margin="5" />
				<xctk:IntegerUpDown
					Grid.Column="1"
					Grid.Row="2"
					IsEnabled="{Binding ElementName=UnlimitedBox, Path=IsChecked, Converter={StaticResource InvertedBooleanConverter}}"
					Value="{Binding OneThousandRate}"
					VerticalAlignment="Center"
					Margin="5" />
				<TextBlock
					Grid.Row="3"
					Text="5000 пользователей"
					VerticalAlignment="Center"
					Margin="5" />
				<xctk:IntegerUpDown
					Grid.Column="1"
					Grid.Row="3"
					IsEnabled="{Binding ElementName=UnlimitedBox, Path=IsChecked, Converter={StaticResource InvertedBooleanConverter}}"
					Value="{Binding FiveThousandRate}"
					VerticalAlignment="Center"
					Margin="5" />
				<TextBlock
					Grid.Row="4"
					Text="10 000 пользователей"
					VerticalAlignment="Center"
					Margin="5" />
				<xctk:IntegerUpDown
					Grid.Column="1"
					Grid.Row="4"
					IsEnabled="{Binding ElementName=UnlimitedBox, Path=IsChecked, Converter={StaticResource InvertedBooleanConverter}}"
					Value="{Binding TenThousandRate, UpdateSourceTrigger=PropertyChanged}"
					VerticalAlignment="Center"
					Margin="5" />
				<TextBlock
					Grid.Row="5"
					Grid.ColumnSpan="2"
					Text="{Binding TotalUsers, UpdateSourceTrigger=PropertyChanged, Mode=OneWay, StringFormat=Всего пользователей: {0}, TargetNullValue=''}"
					Visibility="{Binding ElementName=UnlimitedBox, Path=IsChecked, Converter={StaticResource InvertedBoolToVisibilityConverter}}"
					VerticalAlignment="Center"
					HorizontalAlignment="Center"
					Margin="5"
					FontStyle="Italic"
					FontWeight="ExtraLight"/>
			</Grid>
		</GroupBox>
		<GroupBox
			Grid.Row="3"
			Header="Модули"
			IsEnabled="{Binding ElementName=DemoRadioButton, Path=IsChecked, Converter={StaticResource InvertedBooleanConverter}}"
			Margin="15 5">
			<Grid Margin="15 5">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" SharedSizeGroup="FirstColumn" />
					<ColumnDefinition />
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition />
					<RowDefinition />
					<RowDefinition />
					<RowDefinition />
					<RowDefinition />
				</Grid.RowDefinitions>
				<TextBlock
					Text="Сервер A.C. Tech"
					Margin="5"
					VerticalAlignment="Center"/>
				<CheckBox
					Grid.Column="1"
					IsEnabled="False"
					IsChecked="True"
					VerticalAlignment="Center"
					VerticalContentAlignment="Center"
					IsTabStop="False"/>
				<TextBlock
					Grid.Row="1"
					Text='"Учет рабочего времени"'
					Margin="5"
					VerticalAlignment="Center"/>
				<CheckBox
					Grid.Row="1"
					Grid.Column="1"
					IsChecked="{Binding CurrentLicense.IsEnabledURV}"
					VerticalAlignment="Center"
					VerticalContentAlignment="Center"/>
				<TextBlock
					Grid.Row="2"
					Text='"Фотоверификация"'
					Margin="5"
					VerticalAlignment="Center"/>
				<CheckBox
					Grid.Row="2"
					Grid.Column="1"
					IsChecked="{Binding CurrentLicense.IsEnabledPhotoVerification}"
					VerticalAlignment="Center"
					VerticalContentAlignment="Center"/>
				<TextBlock
					Grid.Row="3"
					Text="'Интеграция видео RVi'"
					Margin="5"
					VerticalAlignment="Center"/>
				<CheckBox
					Grid.Row="3"
					Grid.Column="1"
					IsChecked="{Binding CurrentLicense.IsEnabledRVI}"
					VerticalAlignment="Center"
					VerticalContentAlignment="Center"/>
				<TextBlock
					Grid.Row="4"
					Text='"Автоматизация"'
					Margin="5"
					VerticalAlignment="Center"/>
				<CheckBox
					Grid.Row="4"
					Grid.Column="1"
					IsChecked="{Binding CurrentLicense.IsEnabledAutomation}"
					VerticalAlignment="Center"
					VerticalContentAlignment="Center"/>
			</Grid>
		</GroupBox>
		<Grid
			Grid.Column="1"
			Grid.Row="3"
			Margin="15 5">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="Auto" />
				<RowDefinition />
			</Grid.RowDefinitions>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto" />
				<ColumnDefinition />
			</Grid.ColumnDefinitions>
			<TextBlock
				Text="Название организации"
				VerticalAlignment="Center"
				Margin="5"/>
			<TextBox
				Grid.Column="1"
				Text="{Binding OrganisationName, UpdateSourceTrigger=PropertyChanged}"
				VerticalAlignment="Center"
				Margin="5"/>
			<TextBlock
				Grid.Row="1"
				Text="Сохранить файл в"
				VerticalAlignment="Center"
				Margin="5"/>
			<Grid
				Grid.Row="1"
				Grid.Column="1">
				<Grid.ColumnDefinitions>
					<ColumnDefinition />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>
				<Border
					BorderBrush="LightGray"
					BorderThickness="1"
					CornerRadius="2"
					Margin="5">
					<TextBlock
						Text="{Binding ResultPathToSave, Mode=TwoWay}"
						VerticalAlignment="Center"/>
				</Border>
				<Button
					Grid.Column="1"
					cal:Message.Attach="ShowSaveDialog"
					VerticalAlignment="Center"
					Content="..." />
			</Grid>
			<TextBlock
				VerticalAlignment="Bottom"
				Grid.Row="2"
				Grid.ColumnSpan="2"
				HorizontalAlignment="Center"
				Text="{Binding ResultMessage, UpdateSourceTrigger=PropertyChanged, FallbackValue=None, NotifyOnTargetUpdated=True}">
				<TextBlock.Triggers>
					<EventTrigger RoutedEvent="Binding.TargetUpdated">
						<BeginStoryboard>
							<Storyboard>
								<DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:0" To="1.0" />
								<DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:2" From="1.0" To="0.0" BeginTime="0:0:1" />
							</Storyboard>
						</BeginStoryboard>
					</EventTrigger>
				</TextBlock.Triggers>
			</TextBlock>
		</Grid>
		<Button
			x:Name="GenerateButton"
			Grid.Row="4"
			Grid.Column="1"
			IsDefault="True"
			cal:Message.Attach="GenerateKey"
			Content="Сформировать лицензию"
			VerticalAlignment="Center"
			HorizontalAlignment="Center"
			MinWidth="220"
			Margin="5 5 5 15"/>
	</Grid>
</Window>