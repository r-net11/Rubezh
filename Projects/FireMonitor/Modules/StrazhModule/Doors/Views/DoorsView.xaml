<UserControl x:Class="StrazhModule.Views.DoorsView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:Views="clr-namespace:StrazhModule.Views"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:langCommon="clr-namespace:Localization.Strazh.Common;assembly=Localization"
			 xmlns:lang="clr-namespace:Localization.Strazh.Views;assembly=Localization"
			 mc:Ignorable="d" 
             d:DesignHeight="300"
			 d:DesignWidth="300">

	<Grid ScrollViewer.IsDeferredScrollingEnabled="True" VirtualizingStackPanel.VirtualizationMode="Recycling">
		<DataGrid Focusable="True" ItemsSource="{Binding Doors}" SelectedItem="{Binding SelectedDoor}" CanUserSortColumns="True">
			<DataGrid.Columns>
				<DataGridTemplateColumn Header="â„–" SortMemberPath="Door.No" Width="Auto" CanUserResize="False">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<Image Source="/Controls;component/Images/Door.png" VerticalAlignment="Center" Margin="1 0 0 0" />
								<TextBlock Margin="2 0 5 0" VerticalAlignment="Center" Text="{Binding Door.No}" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTemplateColumn Header="{x:Static lang:CommonViews.Door}" Width="*" SortMemberPath="Door.Name">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<Image Source="{Binding State.StateClass, Converter={StaticResource XStateClassToIconConverter}}" Width="16" Height="16" VerticalAlignment="Center" />
								<TextBlock HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2 0 0 0">
									<Hyperlink Command="{Binding ShowPropertiesCommand}" Style="{StaticResource HyperlinkStyle2}" >
										<TextBlock Text="{Binding Door.Name}" />
									</Hyperlink>
									<TextBlock.ContextMenu>
										<ContextMenu>
											<IconedMenuItem Text="{x:Static langCommon:CommonResources.ResetBreakinState}" Command="{Binding ClearPromptWarningCommand}" />
											<Separator/>
											<IconedMenuItem Text="{x:Static langCommon:CommonResources.ModeOpen}" Command="{Binding DoorAccessStateOpenAlwaysCommand}" />
											<IconedMenuItem Text="{x:Static langCommon:CommonResources.ModeNorm}" Command="{Binding DoorAccessStateNormalCommand}" />
											<IconedMenuItem Text="{x:Static langCommon:CommonResources.ModeClose}" Command="{Binding DoorAccessStateCloseAlwaysCommand}" />
											<Separator/>
											<IconedMenuItem Text="{x:Static langCommon:CommonResources.Open}" Command="{Binding OpenCommand}" />
											<IconedMenuItem Text="{x:Static langCommon:CommonResources.Close}" Command="{Binding CloseCommand}" />
											<Separator/>
											<IconedMenuItem ImageSource="BMap"  Text="{x:Static lang:CommonViews.ShowOnPlan}" Command="{Binding ShowOnPlanCommand}" />
											<IconedMenuItem ImageSource="BJournal" Text="{x:Static langCommon:CommonResources.ShowRelatedEvents}" Command="{Binding ShowJournalCommand}" />
											<IconedMenuItem ImageSource="BSettings"  Text="{x:Static lang:CommonViews.Properties}" Command="{Binding ShowPropertiesCommand}" />
										</ContextMenu>
									</TextBlock.ContextMenu>
								</TextBlock>
								<StackPanel.InputBindings>
									<MouseBinding MouseAction="LeftDoubleClick" Command="{Binding ShowOnPlanCommand}" />
								</StackPanel.InputBindings>
								<StackPanel.ToolTip>
									<Views:SKDDoorTooltipView />
								</StackPanel.ToolTip>
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
                <DataGridTextColumn Binding="{Binding Door.Description}" Header="{x:Static lang:CommonViews.Note}" Width="*" />
                <DataGridTemplateColumn Header="{x:Static lang:CommonViews.EntranceDevice}" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<TextBlock VerticalAlignment="Center" Visibility="{Binding HasInDevice, Converter={StaticResource BoolToVisibilityConverter}}">
								<Hyperlink Command="{Binding ShowInDeviceCommand}" Style="{StaticResource HyperlinkStyle2}">
									<StackPanel Orientation="Horizontal">
										<Image Width="16" Height="16" Margin="5 0" HorizontalAlignment="Left" Source="{Binding InDevice.Driver.ImageSource}" />
										<TextBlock HorizontalAlignment="Stretch" Text="{Binding InDevice.Name}" ToolTip="{Binding InDevice.Name}" />
									</StackPanel>
								</Hyperlink>
							</TextBlock>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
                <DataGridTemplateColumn Header="{x:Static lang:CommonViews.ExitDevice}" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<TextBlock VerticalAlignment="Center" Visibility="{Binding HasOutDevice, Converter={StaticResource BoolToVisibilityConverter}}">
								<Hyperlink Command="{Binding ShowOutDeviceCommand}" Style="{StaticResource HyperlinkStyle2}">
									<StackPanel Orientation="Horizontal">
										<Image Width="16" Height="16" Margin="5 0" HorizontalAlignment="Left" Source="{Binding OutDevice.Driver.ImageSource}" />
										<TextBlock HorizontalAlignment="Stretch" Text="{Binding OutDevice.Name}" ToolTip="{Binding OutDevice.Name}" />
									</StackPanel>
								</Hyperlink>
							</TextBlock>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</DataGrid>
	</Grid>
</UserControl>