<UserControl
	x:Class="JournalModule.Views.ArchiveFilterView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:layout="clr-namespace:Controls.ListViewLayoutManager;assembly=Controls"
	xmlns:Converters="clr-namespace:JournalModule.Converters"
	xmlns:ExtToolkit="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit.Extended"
	xmlns:Controls="clr-namespace:Controls;assembly=Controls"
	xmlns:tree="clr-namespace:Controls.TreeList;assembly=Controls"
	xmlns:behaviours="clr-namespace:Controls.Behaviours;assembly=Controls"
    xmlns:res="clr-namespace:JournalModule.Resources.Language"
	MinWidth="720"
	MinHeight="400">
	<UserControl.Resources>
		<Converters:ArchiveDefaultStateTypeToStringConverter x:Key="ArchiveDefaultStateTypeToStringConverter" />
	</UserControl.Resources>
	<DockPanel>
		<Grid
			Margin="0 5 0 0"
			DockPanel.Dock="Bottom">
			<Grid.ColumnDefinitions>
				<ColumnDefinition />
				<ColumnDefinition />
			</Grid.ColumnDefinitions>
			<Button
				Content="{x:Static res:ArchiveFilterView.ClearSettings}"
				Command="{Binding ClearCommand}"
				HorizontalAlignment="Left"
				Width="200" />
			<StackPanel
				Grid.Column="1"
				HorizontalAlignment="Right"
				Orientation="Horizontal">
				<Button
					Width="100"
					Command="{Binding SaveCommand}"
					Margin="2"
					Content="{x:Static res:ArchiveFilterView.Ok}"
					IsDefault="True" />
				<Button
					Width="100"
					Margin="2"
					Command="{Binding CancelCommand}"
					Content="{x:Static res:ArchiveFilterView.Cancel}" />
			</StackPanel>
		</Grid>
		<TabControl>
			<TabItem
				Header="{x:Static res:ArchiveFilterView.TimeInterval}"
				DataContext="{Binding ArchiveDateTimeViewModel}">
				<StackPanel Margin="25">
					<StackPanel Orientation="Horizontal" Margin="2">
						<TextBlock
							Text="{x:Static res:ArchiveFilterView.Interval}"
							Width="100"
							VerticalAlignment="Center"
							Foreground="White" />
						<ComboBox
							ItemsSource="{Binding ArchiveDefaultStateTypes}"
							SelectedItem="{Binding SelectedArchiveDefaultStateType}"
							Width="250"
							Margin="2">
							<ComboBox.ItemTemplate>
								<DataTemplate>
									<TextBlock Text="{Binding ., Converter={StaticResource EnumToDescriptionConverter}}" Margin="1" />
								</DataTemplate>
							</ComboBox.ItemTemplate>
						</ComboBox>
					</StackPanel>
					<ExtToolkit:IntegerUpDown
						Minimum="1"
						Maximum="1000"
						Value="{Binding Count, UpdateSourceTrigger=PropertyChanged}"
						Visibility="{Binding IsCountVisible, Converter={StaticResource BoolToVisibilityConverter}}"
						HorizontalAlignment="Left"
						Width="200"
						Margin="104 2 0 0" />
					<StackPanel
						Orientation="Horizontal"
						Visibility="{Binding IsStartDateVisible, Converter={StaticResource BoolToVisibilityConverter}}"
						Margin="5">
						<TextBlock
							Text="{x:Static res:ArchiveFilterView.StartDate}"
							Width="100"
							VerticalAlignment="Center"
							Foreground="White" />
						<DatePicker
							behaviours:DatePickerCustomWatermark.Watermark="{StaticResource WatermarkColor}"
							behaviours:DatePickerCustomWatermark.WatermarkText="{x:Static res:ArchiveFilterView.DateWatermark}"
							Validation.ErrorTemplate="{x:Null}"
							VerticalAlignment="Center"
							DisplayDateStart="{Binding ArchiveFirstDate, Mode=OneWay}"
							SelectedDate="{Binding StartDateTime.Date, UpdateSourceTrigger=PropertyChanged}"
							DisplayDate="{Binding StartDateTime.Date, UpdateSourceTrigger=PropertyChanged}" />
						<Controls:TimePicker
							VerticalAlignment="Center"
							TimeSpan="{Binding StartDateTime.Time, UpdateSourceTrigger=PropertyChanged}"
							Margin="5" />
					</StackPanel>
					<StackPanel
						Orientation="Horizontal"
						Visibility="{Binding IsEndDateVisible, Converter={StaticResource BoolToVisibilityConverter}}"
						Margin="5">
						<TextBlock
							Text="{x:Static res:ArchiveFilterView.EndDate}"
							Width="100"
							VerticalAlignment="Center"
							Foreground="White" />
						<DatePicker
							behaviours:DatePickerCustomWatermark.Watermark="{StaticResource WatermarkColor}"
							behaviours:DatePickerCustomWatermark.WatermarkText="{x:Static res:ArchiveFilterView.DateWatermark}"
							Validation.ErrorTemplate="{x:Null}"
							VerticalAlignment="Center"
							DisplayDateStart="{Binding ArchiveFirstDate, Mode=OneWay}"
							SelectedDate="{Binding EndDateTime.Date, UpdateSourceTrigger=PropertyChanged}"
							DisplayDate="{Binding EndDateTime.Date, UpdateSourceTrigger=PropertyChanged}" />
						<Controls:TimePicker
							VerticalAlignment="Center"
							TimeSpan="{Binding EndDateTime.Time, UpdateSourceTrigger=PropertyChanged}"
							Margin="5" />
					</StackPanel>
					<CheckBox
						IsChecked="{Binding UseDeviceDateTime, UpdateSourceTrigger=PropertyChanged}"
						Content="{x:Static res:ArchiveFilterView.UseDeviceDate}"
						Foreground="White"
						Margin="106 2 0 0" />
				</StackPanel>
			</TabItem>
            <TabItem Header="{x:Static res:ArchiveFilterView.Event}" DataContext="{Binding FilterNamesViewModel}">
				<tree:TreeList
					layout:ListViewLayoutManager.Enabled="True"
					Focusable="False"
					Source="{Binding RootFilters}"
					SelectedTreeNode="{Binding SelectedFilter}"
					ScrollViewer.IsDeferredScrollingEnabled="True"
					VirtualizingStackPanel.IsVirtualizing="True"
					VirtualizingStackPanel.VirtualizationMode="Recycling"
					tree:SortBehavior.CanUserSortColumns="False"
					Margin="-5">
					<tree:TreeList.View>
						<GridView>
                            <GridViewColumn Header="{x:Static res:ArchiveFilterView.Name}" layout:ProportionalColumn.Width="1">
								<GridViewColumn.CellTemplate>
									<DataTemplate>
										<StackPanel Orientation="Horizontal">
											<Image
												Width="16"
												Height="16"
												Source="{Binding ImageSource}"
												HorizontalAlignment="Left"
												Margin="5 0" />
											<CheckBox
												IsChecked="{Binding IsChecked}"
												Content="{Binding Name}"
												HorizontalAlignment="Left"
												VerticalAlignment="Center"
												Margin="2" />
										</StackPanel>
									</DataTemplate>
								</GridViewColumn.CellTemplate>
							</GridViewColumn>
						</GridView>
					</tree:TreeList.View>
				</tree:TreeList>
			</TabItem>
            <TabItem Header="{x:Static res:ArchiveFilterView.Object}" DataContext="{Binding FilterObjectsViewModel}">
				<tree:TreeList
					layout:ListViewLayoutManager.Enabled="True"
					Focusable="False"
					Source="{Binding RootFilters, IsAsync=True}"
					SelectedTreeNode="{Binding SelectedFilter}"
					tree:SortBehavior.CanUserSortColumns="False"
					ScrollViewer.IsDeferredScrollingEnabled="True"
					VirtualizingStackPanel.IsVirtualizing="True"
					VirtualizingStackPanel.VirtualizationMode="Recycling"
					Margin="-5">
					<tree:TreeList.View>
						<GridView>
                            <GridViewColumn Header="{x:Static res:ArchiveFilterView.Name}" layout:ProportionalColumn.Width="1">
								<GridViewColumn.CellTemplate>
									<DataTemplate>
										<StackPanel Orientation="Horizontal">
											<Image
												Width="16"
												Height="16"
												Source="{Binding ImageSource}"
												HorizontalAlignment="Left"
												Margin="5 0" />
											<CheckBox IsChecked="{Binding IsChecked}" />
											<TextBlock
												Text="{Binding Name}"
												HorizontalAlignment="Left"
												VerticalAlignment="Center"
												Width="1000"
												Margin="2" />
										</StackPanel>
									</DataTemplate>
								</GridViewColumn.CellTemplate>
							</GridViewColumn>
						</GridView>
					</tree:TreeList.View>
				</tree:TreeList>
			</TabItem>
		</TabControl>
	</DockPanel>
</UserControl>